<div class="profile-header">
    <div class="profile-avatar avatar avatar--140">
        <img *ngIf="!tmpUser._avatar && authService.currentUser._avatar" [src]="authService.currentUser._avatar.getPath('140x140')"  alt="{{authService.currentUser?.name}} avatar">
        {{authService.currentUser.name.charAt(0)}}

        <div class="profile-avatar-tmp" *ngIf="tmpUser._avatar">
            <img [src]="tmpUser._avatar.getPath('original')" />
        </div>
        <div class="profile-avatar-uploader">
            <span class="profile-avatar-uploader-icon material-icons">cloud_upload</span>
            <input (change)="onAvatarFileChange($event)" type="file" ng2FileSelect [uploader]="uploader" />
        </div>
    </div>
    <div class="profile-header-infos">
        <div class="profile-header-top">
            <div class="profile-infos-name">
                <h2 class="profile-name">
                    <!-- {{authService.currentUser.name}} -->
                    <input type="text" [(ngModel)]="tmpUser.name" /><!-- add disabled when !edit -->
                </h2>
                <h3 class="profile-username">@{{authService.currentUser.username}}</h3>
            </div>
            <div class="profile-infos-edit">
                <input class="btn btn-sm btn--light-op" type="submit" value="Edit" />
                <input *ngIf="tmpUser._avatar" class="btn btn-sm btn-success" type="submit" (click)="updateAvatar()" value="Save" />
                <input *ngIf="tmpUser._avatar" class="btn btn-sm btn-secondary" type="submit" (click)="cancelUpdateAvatar()" value="Cancel" />

                <input *ngIf="tmpUser.name" class="btn btn-sm btn-success" type="submit" (click)="updateName()" value="Save" />
            </div>
        </div>
        <div class="profile-header-bottom">
            <div class="profile-infos-bio">
                <p *ngIf="authService.currentUser.bio">{{authService.currentUser.bio}}</p>
                <p *ngIf="!authService.currentUser.bio">You don't have bio yet...</p>
            </div>
        </div>
    </div>
</div>

<div class="account-settings section">
    <h2 class="section-title withDescription">Account</h2>
    <p class="section-description">Change my basic account settings.</p>

    <div class="list-item">
        <div class="list-item-infos">
            <h3 class="list-item-title">My username</h3>
            <p class="list-item-description">http://invow.io/<input [(ngModel)]="tmpUser.username" (keyup)="onUsernameKeyUp()" (keydown)="onUsernameKeyDown()" class="list-item-description-darker" type="input"/></p><!-- disabled if !edit -->
            <div *ngIf="tmpUser.username == authService.currentUser.username" class="list-item-status">
                <small class="text-success">Thatâ€™s your current username!</small>
            </div>
            <div *ngIf="tmpUser.username != authService.currentUser.username" class="list-item-status">
                <small class="text-muted" *ngIf="validatingUsername">Validation in progress..</small>
                <small class="text-success" *ngIf="!validatingUsername && usernameValid">This username is available</small>
                <small class="text-danger" *ngIf="!validatingUsername && !usernameValid">This username is not available</small>
            </div>
        </div>
        <div class="list-item-actions">
            <input class="btn btn-sm btn-secondary-outline" type="submit" value="Edit username"/>
            <input [disabled]="!usernameValid" (click)="updateUsername()" class="btn btn-sm btn-success" type="submit" value="Save"/>
            <a class="btn btn-sm btn-secondary">Cancel</a>
        </div>
    </div>

    <div class="list-item">
        <div class="list-item-infos">
            <h3 class="list-item-title">My email</h3>
            <input class="list-item-description-darker" type="input" disabled value="{{authService.currentUser.email}}"/>
        </div>
        <div class="list-item-actions">
            <input class="btn btn-sm btn-secondary-outline" type="submit" value="Edit email">
            <input class="btn btn-sm btn-success" type="submit" disabled value="Save"/>
            <a class="btn btn-sm btn-secondary">Cancel</a>
        </div>
    </div>
</div>

<div class="connections-settings section">
    <h2 class="section-title withDescription">Connections</h2>
    <p class="section-description">Manage the apps connections.</p>

    <div class="list-item">
        <div class="list-item-infos">
            <h3 class="list-item-title">Connect to Facebook</h3>
            <p class="list-item-description">Use my Facebook account to login. <strong>We will never post to Facebook or message your friends without your permission.</strong></p>
        </div>
        <div class="list-item-actions" *ngIf="!authService.currentUser.facebook?.id">
            <a class="btn btn-sm btn--facebook" href="auth/facebook">Link Facebook</a>
        </div>
        <div class="list-item-actions" *ngIf="authService.currentUser.facebook?.id && (authService.currentUser.local?.active || authService.currentUser.google?.id || authService.currentUser.twitter?.id)">
            <a class="btn btn-sm btn-secondary-outline" (click)="unlinkAccount('FACEBOOK')">Unlink Facebook</a>
        </div>
    </div>
    <div class="list-item">
        <div class="list-item-infos">
            <h3 class="list-item-title">Connect to Twitter</h3>
            <p class="list-item-description">Use my Twitter account to login. <strong>We will never post to Twitter or message your followers without your permission.</strong></p>
        </div>
        <div class="list-item-actions" *ngIf="!authService.currentUser.twitter?.id">
            <a class="btn btn-sm btn--twitter" href="auth/twitter">Link Twitter</a>
        </div>
        <div class="list-item-actions" *ngIf="authService.currentUser.twitter?.id && (authService.currentUser.local?.active || authService.currentUser.google?.id || authService.currentUser.facebook?.id)">
            <a class="btn btn-sm btn-secondary-outline" (click)="unlinkAccount('TWITTER')">Unlink Twitter</a>
        </div>
    </div>
    <div class="list-item">
        <div class="list-item-infos">
            <h3 class="list-item-title">Connect to Google</h3>
            <p class="list-item-description">Use my Google account to login. <strong>We will never post to Google or message your friends without your permission.</strong></p>
        </div>
        <div class="list-item-actions" *ngIf="!authService.currentUser.google?.id">
            <a class="btn btn-sm btn--google" (click)="unlinkAccount('GOOGLE')">Link Google</a>
        </div>
        <div class="list-item-actions" *ngIf="authService.currentUser.twitter?.id && (authService.currentUser.local?.active || authService.currentUser.twitter?.id || authService.currentUser.facebook?.id)">
            <a class="btn btn-sm btn-secondary-outline" href="auth/facebook">Unlink Google</a>
        </div>
    </div>
</div>

<div class="security-settings section">
    <h2 class="section-title withDescription">Security</h2>
    <p class="section-description">Change my security settings.</p>

    <div class="list-item">
        <p class="list-item-description">Nothing here...</p>
    </div>
</div>
